<!DOCTYPE html>
<html lang="zxx" class="js">

<head>
    <meta charset="utf-8">
    <meta name="author" content="Softnio">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description"
        content="A powerful and conceptual apps base dashboard template that especially build for developers and programmers.">
    <!-- Fav Icon  -->
    <link rel="shortcut icon" href="./images/favicon.png">
    <!-- Page Title  -->
    <title>Blank - Layout | DashLite Admin Template</title>
    <!-- StyleSheets  -->
    <link rel="stylesheet" href="./assets/css/dashlite.css?ver=3.1.3">
    <link id="skin-default" rel="stylesheet" href="./assets/css/theme.css?ver=3.1.3">
</head>

<body class="nk-body ui-rounder has-sidebar ">
    <div class="nk-app-root">
        <!-- main @s -->
        <div class="nk-main ">
            <!-- sidebar @s -->
            <div class="nk-sidebar is-dark nk-sidebar-fixed is-dark " data-content="sidebarMenu">
                <div class="nk-sidebar-element nk-sidebar-head">
                    <div class="nk-sidebar-brand">
                        <a class="sidebar-brand" href="index.html">
                            <span class="align-middle">Albuhaira</span>
                        </a>
                    </div>
                    <div class="nk-menu-trigger me-n2">
                        <a href="#" class="nk-nav-toggle nk-quick-nav-icon d-xl-none" data-target="sidebarMenu"><em
                                class="icon ni ni-arrow-left"></em></a>
                    </div>
                </div><!-- .nk-sidebar-element -->
                <div class="nk-sidebar-element">
                    <div class="nk-sidebar-content">
                        <div class="nk-sidebar-menu" data-simplebar>
                            <ul class="nk-menu">
                                <li class="nk-menu-heading">
                                    <h6 class="overline-title text-primary-alt">Dashboards</h6>
                                </li><!-- .nk-menu-item -->
                                <li class="nk-menu-item">
                                    <a href="index.html" class="nk-menu-link">
                                        <span class="nk-menu-icon"><em class="icon ni ni-presentation"></em></span>
                                        <span class="nk-menu-text">Dashboard</span>
                                    </a>
                                </li>

                                <li class="nk-menu-heading">
                                    <h6 class="overline-title text-primary-alt">Gesions</h6>
                                </li>
                                <li class="nk-menu-item has-sub">
                                    <a href="#" class="nk-menu-link nk-menu-toggle">
                                        <span class="nk-menu-icon"><em class="icon ni ni-tile-thumb"></em></span>
                                        <span class="nk-menu-text">Gesion des données</span>
                                    </a>
                                    <ul class="nk-menu-sub">
                                        <li class="nk-menu-item">
                                            <a href="participants.html" class="nk-menu-link"><span
                                                    class="nk-menu-text">Participants</span></a>
                                        </li>
                                        <li class="nk-menu-item">
                                            <a href="lotissements.html" class="nk-menu-link"><span
                                                    class="nk-menu-text">Lotissements</span></a>
                                        </li>
                                        <li class="nk-menu-item">
                                            <a href="vocations.html" class="nk-menu-link"><span
                                                    class="nk-menu-text">Vocations</span></a>
                                        </li>
                                        <li class="nk-menu-item">
                                            <a href="lots.html" class="nk-menu-link"><span
                                                    class="nk-menu-text">Lots</span></a>
                                        </li>
                                    </ul>
                                </li>


                                <li class="nk-menu-item has-sub">
                                    <a href="#" class="nk-menu-link nk-menu-toggle">
                                        <span class="nk-menu-icon"><em class="icon ni ni-tranx"></em></span>
                                        <span class="nk-menu-text">Gesion des soumissions</span>
                                    </a>
                                    <ul class="nk-menu-sub">
                                        <li class="nk-menu-item">
                                            <a href="appel_offre.html" class="nk-menu-link"><span
                                                    class="nk-menu-text">Appel d'offre</span></a>
                                        </li>
                                        <li class="nk-menu-item">
                                            <a href="retrait_cahier_de_charge.html" class="nk-menu-link"><span
                                                    class="nk-menu-text">Retrait cahier de charge</span></a>
                                        </li>
                                    </ul>
                                </li>

                                <li class="nk-menu-heading">
                                    <h6 class="overline-title text-primary-alt">Importation / Exportation</h6>
                                </li><!-- .nk-menu-item -->
                                <li class="nk-menu-item">
                                    <a href="importer_exporter.html" class="nk-menu-link">
                                        <span class="nk-menu-icon"><em class="icon ni ni-layers"></em></span>
                                        <span class="nk-menu-text">Importation / Exportation</span>
                                    </a>
                                </li>

                                <li class="nk-menu-heading">
                                    <h6 class="overline-title text-primary-alt">Statistiques</h6>
                                </li>

                                <li class="nk-menu-item has-sub">
                                    <a href="#" class="nk-menu-link nk-menu-toggle">
                                        <span class="nk-menu-icon"><em class="icon ni ni-tranx"></em></span>
                                        <span class="nk-menu-text">Rapport</span>
                                    </a>
                                    <ul class="nk-menu-sub">
                                        <li class="nk-menu-item">
                                            <a href="depouillement.html" class="nk-menu-link"><span
                                                    class="nk-menu-text">Dépouillement</span></a>
                                        </li>
                                        <li class="nk-menu-item">
                                            <a href="html/project-list.html" class="nk-menu-link"><span
                                                    class="nk-menu-text">Retrait dossier</span></a>
                                        </li>
                                    </ul>
                                </li>

                                <li class="nk-menu-heading">
                                    <h6 class="overline-title text-primary-alt">Utilisateur</h6>
                                </li><!-- .nk-menu-item -->
                                <li class="nk-menu-item">
                                    <a href="#" id="disconnectBtn" class="nk-menu-link">
                                        <span class="nk-menu-icon"><em class="icon ni ni-signin"></em></span>
                                        <span class="nk-menu-text">Log out</span>
                                    </a>
                                </li><!-- .nk-menu-item -->

                            </ul><!-- .nk-menu -->
                        </div><!-- .nk-sidebar-menu -->
                    </div><!-- .nk-sidebar-content -->
                </div><!-- .nk-sidebar-element -->
            </div>
            <!-- sidebar @e -->
            <!-- wrap @s -->
            <div class="nk-wrap ">
                <!-- main header @s -->
                <div class="nk-header is-light nk-header-fixed is-light">
                    <div class="container-xl wide-xl">
                        <div class="nk-header-wrap">
                            <div class="nk-menu-trigger d-xl-none ms-n1 me-3">
                                <a href="#" class="nk-nav-toggle nk-quick-nav-icon" data-target="sidebarMenu"><em
                                        class="icon ni ni-menu"></em></a>
                            </div>
                            <div class="nk-header-brand d-xl-none">
                                <a href="html/index.html" class="logo-link">
                                    <img class="logo-light logo-img" src="./images/logo_albuhaira.svg" alt="logo">
                                    <img class="logo-dark logo-img" src="./images/logo_albuhaira.svg" alt="logo-dark">
                                </a>
                            </div><!-- .nk-header-brand -->
                        </div><!-- .nk-header-wrap -->
                    </div><!-- .container-fliud -->
                </div>

                <div class="nk-content nk-content-fluid">
                    <div class="container-xl wide-xl">
                        <div class="nk-content-body">
                            <div class="card card-preview">
                                <div class="card-inner">
                                    <div class="preview-block">
                                        <form enctype="multipart/form-data">
                                            <div class="row gy-4">
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="form-label">Importer les données</label>

                                                        <div class="form-control-wrap">
                                                            <div class="form-file">
                                                                <input type="file" class="form-file-input"
                                                                    id="fileInput">
                                                                <label class="form-file-label" for="customFile">Choose
                                                                    file</label>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-sm-6">
                                                    <div class="form-group">
                                                        <label class="form-label" style="color: white;">s</label>
                                                        <div class="form-control-wrap">
                                                            <a id="import" href="#" class="btn btn-success">Importer</a>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div><!-- .card-preview -->
                        </div>
                    </div>
                </div>

                <div class="modal fade" tabindex="-1" id="modalResult">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <a href="#" class="close" data-bs-dismiss="modal"><em class="icon ni ni-cross"></em></a>
                            <div class="modal-body modal-body-lg text-center">
                                <div class="nk-modal">
                                    <em class="nk-modal-icon icon icon-circle icon-circle-xxl ni ni-check bg-success"></em>
                                    <h4 class="nk-modal-title">Success</h4>
                                    <div class="nk-modal-text">
                                        <div class="caption-text" id="result"></div>
                                        
                                    </div>
                                    <div class="nk-modal-action">
                                        <a href="#" class="btn btn-lg btn-mw btn-primary" data-bs-dismiss="modal">OK</a>
                                    </div>
                                </div>
                            </div><!-- .modal-body -->
                            
                        </div>
                    </div>
                </div>

                <div class="nk-footer">
                    <div class="container-xl wide-xl">
                        <div class="nk-footer-wrap">
                            <div class="nk-footer-copyright"> &copy; 2023 DashLite. Template by <a
                                    href="https://softnio.com" target="_blank">Softnio</a>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!-- wrap @e -->
        </div>
        <!-- main @e -->
    </div>
    <script src="./assets/js/bundle.js?ver=3.1.3"></script>
    <script src="./assets/js/scripts.js?ver=3.1.3"></script>

    <script>
        $(document).ready(function () {
            $("#import").click(function () {

                const formData = new FormData();
                formData.append("excelFile", $("#fileInput")[0].files[0]);

                $.ajax({
                    type: "POST",
                    url: "api/import/insert-excel-data",
                    data: formData,
                    processData: false,
                    contentType: false,
                    success: function (response) {
                        $("#result").html(response.message);
                        $("#modalResult").modal('show');
                        $("#fileInput").val("");
                    },
                    error: function (xhr, status, error) {
                        alert("error " + error);
                    }
                });
            });
        });
    </script>
</body>

</html>